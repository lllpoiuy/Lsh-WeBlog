### Drzewa rozpinające

> 给定一个长为 $n$ 的整数序列 $a_1,a_2,\ldots,a_n$。根据这个序列你可以生成一个 $n$ 个节点的无向图：节点 $i$ 和 $j$ 之间（对于 $i\neq j$）有 $\gcd(a_i,a_j)$ 条可区分的边将这两个节点相连。你的任务是计算这个图的生成树数量。如果对于两棵树，其中一棵树包含另一棵树中不存在的边，那么就认为这两棵树不同。因为生成树数量很大，请输出它对 $10^9+7$ 取模后的值。$n\le 5000$。

### Walizki

> Byteasar 负责评估新规划的 Byteburg Bitom 机场的行李大厅的设计。根据规划，大厅里将有 $n$ 个平台，用 $1$ 到 $n$ 的整数编号，每个行李箱最初都要运输到第一个平台。一些单向传送带可以从平台出发，连接到编号严格更大的平台。如果一个平台没有传送带出口，在这个平台的行李箱将由机场工作人员手动拿走并转移到相应的飞机上。另一方面，如果平台接有多条出口传送带，那么传送带的顺序就很重要——第一个行李箱遇到这样的平台，就会从第一条传送带上离开，第二个就会从第二条上离开，以此类推。当行李箱从最后一条传送带离开平台时，下一个行李箱又会从第一条传送带离开，如此循环往复。
>
> 一旦一个行李箱被送到第一个平台，它在传送带上的运输和工作人员的收集都在下一个行李箱放在第一个平台之前进行。换句话说，在任何时候，最多只有一个行李箱在传送带上运输。
>
> 可以想见，在处理了一定数量的行李箱后，这个行李系统会「复位」，即回到对于每个有出口传送带的平台，行李箱到达平台后都从第一条出口传送带离开的状态。Byteasar 想知道最少处理多少行李箱之后，系统将自我复位。请帮他计算出这个值！$n\le 100$。   

每个点都归位了等价于所以每个点都被经过度数的倍数次，所以我们直接算每个点会经过总次数的多少份之多少：
$$
f_u\cdot \frac 1d\rightarrow f_v
$$
我们用个高精度分数类来算就好了。

### No Bug No Game

> ![](./p17.png)

对于跨过了 $k$ 的那个怪兽，对于它前面的怪兽，距离都至少是 $p_i+1$，后面的怪兽，贡献肯定是 $0$。所以我们枚举这格关键怪兽，枚举它和 $k$ 之间的差，再算出前缀背包和后缀背包，总复杂度 $O(nk|p|)$。

### RPG Pro League

> ![](./p18.png)

首先可以给那个 `two` 单独建一个人，于是就变成了一个左部 $n$ 点、右部 $4$ 点的二分图最大权匹配问题，考虑先 Hall 定理求出最大流，模拟费用流求出一个最小费用最大流。然后单点修改，再消负环。

然后发现有权值的只有和源点相连的左部点之间的边，那么只要找到这两条边之间能到达，且一个大于另一个，就找了负环。维护右部点两两可达性，然后直接枚举环就好。$O((n+q)\log n)$。

### Guess Cycle Length

> ![](./p19.png)

考虑交互器后台肯定是个随机数生成器和一个 `map`，这随机数做不到太均匀，所以中位数、平均数都不好用，随机询问 $4000$ 次，拿个最大值来当 $n$ 的大致估计，然后一一 check。

但是 check 实际上可以用 BSGS 的思想来进行，就能 check $3000^2$ 个数，这就稳了。