### Defense of the Ancients

> ![](./p0.png)

设 $\sum a_p=A,\sum b_p=B$，那么只有 $(A,B)$ 构成的下凸包上的点是有用的。而凸包点数是 $M^{2/3}$ 的，可以整个求出来。具体来说，我们求 $ak+b$ 最小的 $k$ 个点就可以找到凸包与斜率 $k$ 的直线的切点。我们求出凸包最靠左和最靠右的两个点，然后以它们之间的斜率为 $k$，找到它们中点的一个点，然后向两侧递归下去。

### Angel and Demon

> ![](./p1.png)

假如 Angel 先手：若初始无最大匹配则失败；否则，就是要加一条边使得 Demon 删哪条边都没用。枚举 Demon 删哪条边，那么可以求出一个 Angel 可以加边可以获得胜利的边集，我们只要把边集求个交就好了。

怎么求出这个边集？那么从 $S$ 出发，可以到达的左部点构成一个集合；右部点可以到达 $T$ 的也构成一个集合。那么只要连一条左集合到右集合的边就可以了。所以，左部点集合可以和右部点集合分别求交。

假如 Demon 先手，就是要删一条边使得最大匹配小于 $n-1$，退流即可。

### Game With A Fairy

> ![](./p2.png)

($n\le 10000$)。shuffle 一下，然后随机查长度为 $2,4,8,16,\cdots$ 的前缀即可。

###  Two Airlines

> ![](./p3.png)

我们维护一条链，左边都是 $B$，右边都是 $W$，设中间界点为 $u$。尝试加入一个点 $v$，查询 $(u,v)$，若为 $W$，则查询 $(u-1,v)$，然后发现一定能插的进去。

### House Moving

>![](./p4.png)
>
>![](./p5.png)

首先，只有一个前缀或者一个后缀的房子是有用的。并且填入的人数肯定是先减小再上升，交界点就是中间的分隔。我们 $dp$，设 $f_{i,j}$ 表示前 $i$ 个人和为 $j$ 的最大值，加入的时候考虑中间这条边的贡献（左边乘右边），恰好是可以算的；最后，中间这条长边的贡献也是很好算的。

###  Eel and Grid

> ![](./p6.png)

考虑每个格子的方向。首先可以发现 $(i,j)$ 和 $(i+1,j+1)$ 的方向是一样的，所以构成了几条对角线，然后单独考虑某一条对角线，考虑不会提前成环的条件并用组合数算算就好了。

###  Travel in Sugar Country

> ![](./p7.jpg)
>
> ![](./p8.png)

直接按照 $K$ 的顺序肯定不能考虑，我们得转置，按照 $1\sim N$ 的顺序去考虑，记下 $2^K$ 表示是否选了，然后贡献也是可以计算的。

事实上，只要记下来划分成几条链就够了！$2^K\rightarrow K$。

### Eels

> 小V有一个水缸和一堆鱼，水缸初始是空的，小 V 接下来会向水缸内加入一些鱼，同时也可能将已加入的鱼捞出来。水缸里的鱼会相互攻击，直到只有一条鱼为止。也就是说如果有 $n$ 条鱼，则会发生 $n-1$ 次攻击。如果一条鱼的重量为 $A$，另一条鱼重量为 $B$，如果 $A\le B$，则 $B$ 鱼会吃掉 $A$ 鱼，然后 $B$ 鱼体重变为 $A+B$。
>
> 对于一场攻击来说，如果一条鱼的重量为 $A$,另一条鱼重量为 $B$，如果 $AB$ 满足条件：$A\le B$ 而且 $B\le 2A$  那么我们定义这场攻击是危险的。
>
> 现在小 $V$ 会有 $q$ 次操作，包括加入一条体重为 $x$ 的鱼，或捞出一条水缸内的、体重为 $x$ 的鱼。
>
> 小 V 想知道，在每次操作后，水缸内能发生的最多的危险攻击次数是多少。

首先，按照哈夫曼树的方式去合并，可以最大化危险攻击次数；一次攻击 $A+B,A<B$ 是危险的，当且仅当 $B$ 前面的所有数的和小于 $B$。

观察到：$[2^k,2^{k+1})$ 中至多有一个数的合并是危险的，并且这个数一定得是这个区间中唯一的数。二进制分组并维护即可。

事实上，这也构成了对哈夫曼树复杂度的证明。

### 今天的课：http://www.nfls.com.cn:10611/contest/702

挺好的课，有趣和轻松。